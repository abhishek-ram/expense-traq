{% extends 'core/layout.html' %}
{% load staticfiles %}
{% load form_extras %}

{% block title %}Expense Tracking - Expense Types{% endblock %}

{% block head_css %}

  <!-- iCheck -->
  <link href="{% static "vendors/iCheck/skins/flat/green.css" %}" rel="stylesheet">

  <!-- Select2 -->
  <link href="{% static "vendors/select2/dist/css/select2.min.css" %}" rel="stylesheet">

{% endblock %}

{% block body_content %}

    <!-- page content -->
  <div class="right_col" role="main">
    <!-- po table -->
    <div class="row">
      <div class="col-md-8 col-sm-8 col-xs-12 col-md-offset-2 col-sm-offset-2">
        <div class="x_panel">
          <div class="x_title">
            {% if form.instance.id %}
            <h3>Edit Expense Type {{ form.instance.id  }}</h3>
            {% else %}
            <h3>Add a new Expense Type</h3>
            {% endif %}
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <form class="form-horizontal form-label-left" method="post">
              {% csrf_token %}

              {% render_input_text form.name%}
              <div class="form-group">
                <label class="col-md-3 col-sm-3 col-xs-12 control-label">Receipt Required
                  <br>
                  <small class="text-navy">Check this box to make expense receipts mandatory</small>
                </label>
                <div class="checkbox">
                  <label class="">
                    <input type="checkbox" class="flat" id="id_receipt_required" name="receipt_required"
                      {% if form.instance.receipt_required %} checked {% endif %}>
                  </label>
                </div>
              </div>
              <br/>

              {{ inline_formset.management_form }}
              <div class="item form-group">
                <label class="col-md-3 col-sm-3 col-xs-12 control-label"> GL Code Mapping</label>
                <div class=" col-md-6 col-sm-6 col-xs-12">
                  <table class="table" id="formset">
                    <thead>
                      <tr>
                        <th>Region</th>
                        <th>GL Code</th>
                        {% if form.instance.id %}<th>Delete</th>{% endif %}
                      </tr>
                    </thead>
                    <tbody>
                      {% for i_form in inline_formset %}
                        <tr>
                          {% for hidden in i_form.hidden_fields %}
                            {{ hidden }}
                          {% endfor %}
                          {% render_inline_form_tb i_form %}
                        </tr>
                      {% endfor %}
                    </tbody>
                  </table>

                </div>
              </div>
              <div class="ln_solid"></div>
              <div class="form-group">
                <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                  <button type="submit" class="btn btn-success">Submit</button>
                </div>
              </div>

            </form>
          </div>
        </div>
      </div>
    <div class="col-md-2 col-sm-2"></div>
    </div>
    <!-- po table -->
  </div>

<!-- /page content -->
{% endblock %}

{% block body_js %}
  <!-- iCheck -->
  <script src="{% static "vendors/iCheck/icheck.min.js" %}"></script>
  <!-- Select2 -->
  <script src="{% static "vendors/select2/dist/js/select2.full.min.js" %}"></script>
  <!-- Formset -->
  <script src="{% static "js/django.formset.js" %}"></script>
  <script>
      $(document).ready(function() {
        // Initialize Select
        $(".select2_single").select2({
			    placeholder: "Select a state",
			    allowClear: true,
          width: '100%'
			  });
      });
      $('#formset').find('tbody tr').formset({
        addText: '<i class="fa fa-plus fa-lg"></i> Add Row',
        addCssClass: 'add-row btn btn-sm btn-info pull-right',
        deleteText: '<i class="fa fa-trash-o fa-lg"></i>',
        deleteCssClass: 'del-row btn btn-sm btn-danger',
        prefix: '{{ inline_formset.prefix }}',
        added: function (row) {
          row.find(".select2_single").select2({
            placeholder: "Select a state",
			      allowClear: true,
            width: '100%'
			    });
        }
      });
  </script>
{% endblock %}